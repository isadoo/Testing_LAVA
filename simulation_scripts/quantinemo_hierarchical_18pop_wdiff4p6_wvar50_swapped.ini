#1 pop - 3 pop - 9 pop Ovaskainen Simulation Style.
#(b) zopt diff = 10 , so in the quantinemo script we have , 
#w foreing = 0.6
# CORRELATED MIGRATION SELECTION

replicates 1

generations 1350
# metapopulation structure and capacities
patch_capacity 1000
patch_number 18  # Total number of patches in the system

# Dispersal rates and matrices
dispersal_rate (1 {{0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11} 
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11} 
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}
                   {0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11 0.11}},  

              300 {{0.33 0.33 0.33 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} 
                   {0.33 0.33 0.33 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}
                   {0.33 0.33 0.33 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} 
                   {0 0 0 0.33 0.33 0.33 0 0 0 0 0 0 0 0 0 0 0 0} 
                   {0 0 0 0.33 0.33 0.33 0 0 0 0 0 0 0 0 0 0 0 0}  
                   {0 0 0 0.33 0.33 0.33 0 0 0 0 0 0 0 0 0 0 0 0} 
                   {0 0 0 0 0 0 0.33 0.33 0.33 0 0 0 0 0 0 0 0 0} 
                   {0 0 0 0 0 0 0.33 0.33 0.33 0 0 0 0 0 0 0 0 0} 
                   {0 0 0 0 0 0 0.33 0.33 0.33 0 0 0 0 0 0 0 0 0}
                   {0 0 0 0 0 0 0 0 0 0.33 0.33 0.33 0 0 0 0 0 0} 
                   {0 0 0 0 0 0 0 0 0 0.33 0.33 0.33 0 0 0 0 0 0}
                   {0 0 0 0 0 0 0 0 0 0.33 0.33 0.33 0 0 0 0 0 0} 
                   {0 0 0 0 0 0 0 0 0 0 0 0 0.33 0.33 0.33 0 0 0} 
                   {0 0 0 0 0 0 0 0 0 0 0 0 0.33 0.33 0.33 0 0 0}  
                   {0 0 0 0 0 0 0 0 0 0 0 0 0.33 0.33 0.33 0 0 0} 
                   {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.33 0.33 0.33} 
                   {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.33 0.33 0.33}  
                   {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.33 0.33 0.33}},  

              1200 {{0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} 
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} 
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} 
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0} 
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}  
                    {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0}})

patch_sample_size 10

# neutral
ntrl_loci 2000
ntrl_all 2
ntrl_mutation_rate 1e-7

# Quantiative trait
quanti_loci		100
quanti_all		2
quanti_environmental_model 2
quanti_heritability 0.8
quanti_allelic_var 0.01
quanti_mutation_rate 1e-7
# Selection
quanti_selection_model 1
quanti_stab_sel_optima (1 {0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0},
                    1200 {-2.3 -1.15 0 -1.15 0 1.15 0 1.15 2.3 -2.3 -1.15 0 -1.15 0 1.15 0 1.15 2.3})
                    
quanti_stab_sel_intensity 50

# neutral output
ntrl_genot_filename     "neutral_data"
ntrl_save_genotype	1
ntrl_genot_logtime	1350

# quanti output 
# dosage
quanti_genot_filename "quanti_trait"
quanti_save_genotype	1
quanti_genot_logtime 1350


# statistics output
stat {n.adlt.fst q.qst adlt.nbInd_p q.meanP_p}
stat_log_time 150